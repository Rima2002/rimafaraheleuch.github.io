<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Sincap: Elma Toplamak</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
      background-color: rgb(169, 236, 169);
      font-family: 'Segoe UI', sans-serif;
    }

    canvas {
      border: 2px solid #aaa;
      background-color: #f1f1f1;
      box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }

    #scoreBoard {
      font-size: 24px;
      font-weight: bold;
      margin: 10px 0;
    }

    #timer {
      font-size: 20px;
      color: #444;
    }

    #controls {
      margin: 15px 0;
    }

    button {
      font-size: 18px;
      padding: 10px 30px;
      margin: 10px;
      border: none;
      border-radius: 8px;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #388E3C;
    }

    #restartButton {
      display: none;
      background-color: #f44336;
    }

    #restartButton:hover {
      background-color: #d32f2f;
    }

    #winMessage {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      padding: 40px 60px;
      border: 3px solid #4CAF50;
      border-radius: 20px;
      font-size: 36px;
      color: #388E3C;
      font-weight: bold;
      box-shadow: 0 0 30px rgba(0, 0, 0, 0.2);
      z-index: 999;
    }


    #howToPlay {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: white;
        border: 3px solid #4CAF50;
        border-radius: 16px;
        padding: 30px 40px;
        font-size: 20px;
        color: #333;
        text-align: center;
        box-shadow: 0 0 25px rgba(0,0,0,0.2);
        z-index: 1000;
    }

    #howToPlay h2 {
        color: #4CAF50;
        margin-top: 0;
    }

  </style>
</head>
<body>
<!-- Skor ve zaman g√∂sterisi -->
  <div id="scoreBoard">Skor: 0</div>
  <div id="timer">Kalan Zaman: 20s</div>

<!-- Oyun kontrol butonlarƒ± -->
  <div id="controls">
    <button id="startButton">Oyunu Ba≈ülat</button>
    <button id="restartButton">Oyunu Yeniden Ba≈üla</button>
  </div>

<!-- Oyunucuya oyun a√ßƒ±klamasƒ± g√∂sterisi -->
  <div id="howToPlay">
  <h2>Nasƒ±l Oynanƒ±r</h2>
    <p>
        üçè Kazanmak i√ßin <strong>8 Elma</strong> topla.<br>
        üïπÔ∏è <strong>Y√∂n tu≈ülarƒ± </strong>kullanarak hareket et.<br>
        üö´ Kahverengi bloklardan ka√ßƒ±n ‚Äî bir vuru≈ü oyunu bitirir.<br>
        ‚è∞ Bunu yapmak i√ßin <strong>20 saniyen</strong> var!</var>!
    </p>
    <p><em>Ba≈ülamak i√ßin ‚ÄúOyunu Ba≈ülat‚Äù tu≈üuna tƒ±kla.</em></p>
  </div>

<!-- Oyun Alanƒ± -->
  <canvas id="canvas" width="900" height="590"></canvas>

<!-- Kazanma mesajƒ± -->
  <div id="winMessage">üéâ Kazandƒ±n!</div>

  <script>
// Canvas ve baƒülamƒ± alƒ±nƒ±r
    const canvas = document.getElementById("canvas");
    const ctx = canvas.getContext("2d");

//UI elementleri
    const scoreBoard = document.getElementById("scoreBoard");
    const startButton = document.getElementById("startButton");
    const restartButton = document.getElementById("restartButton");
    const winMessage = document.getElementById("winMessage");
    const timerDisplay = document.getElementById("timer");

// G√∂rseller ve sesler tanƒ±mlanƒ±r
    const bgImage = new Image();
    const appleImage = new Image();
    const squirrelImage = new Image();

    bgImage.src = "images/background.png";
    appleImage.src = "images/elma.png";
    squirrelImage.src = "images/character.png";

    const collectSound = new Audio("audio/collect_sound.mp3");
    const backgroundMusic = new Audio("audio/background_music.mp3");
    const gameOverSound = new Audio("audio/gameover.mp3");

// M√ºzik d√∂ng√ºde √ßalsƒ±n
    backgroundMusic.loop = true;
    backgroundMusic.volume = 0.4;

// Oyun durumu deƒüi≈ükenleri
    let character;
    let keys = [];
    let score = 0;
    let gameOver = false;
    let gameInterval;
    let timerInterval;
    let timeLeft = 20;

// Elmanƒ±n konumu 
    let appleX, appleY;
    const appleSize = 70;

// Engeller (hareketli bloklar)
    const obstacles = [
      { x: 400, y: 350, width: 80, height: 80, speedX: 3, speedY: 0 },
      { x: 200, y: 100, width: 80, height: 80, speedX: 0, speedY: 3 },
      { x: 700, y: 200, width: 80, height: 80, speedX: 0, speedY: 2 }
    ];

    let loadedAssets = 0;

// T√ºm g√∂rseller y√ºkledikten sonra oyunu ba≈ülat
    function assetLoaded() {
      loadedAssets++;
      if (loadedAssets === 3) {
        initializeCharacter();
        placeApple();
        drawStartScreen();
      }
    }

// G√∂rseller y√ºklendiƒüinde √ßalƒ±≈üacak fonksiyonlar
    bgImage.onload = assetLoaded;
    appleImage.onload = assetLoaded;
    squirrelImage.onload = assetLoaded;

// Karakter sƒ±nƒ±fƒ± tanƒ±mƒ± 
    class Character {
      constructor(width, height, image, x, y) {
        this.width = width;
        this.height = height;
        this.image = image;
        this.x = x;
        this.y = y;
        this.speedX = 0;
        this.speedY = 0;
      }

// Karakteri √ßiz
      draw() {
        ctx.drawImage(this.image, this.x, this.y, this.width, this.height);
      }

// Konumu g√ºncelle
     updatePosition() {
        this.x += this.speedX;
        this.y += this.speedY;
      }

// Elmaya temas kontrol√º 
      isTouchingApple() {
        return (
          appleX >= this.x &&
          appleX + appleSize <= this.x + this.width &&
          appleY >= this.y &&
          appleY + appleSize <= this.y + this.height
        );
      }
    }

// Karakteri ba≈ülat
    function initializeCharacter() {
      character = new Character(150, 150, squirrelImage, 0, 0);
    }

// Elmayƒ± rastgele yerle≈ütir
    function placeApple() {
      appleX = Math.random() * (canvas.width - appleSize);
      appleY = Math.random() * (canvas.height - appleSize);
    }

// Skoru g√ºncelle ve kazanma durumu kontorl√º
    function updateScore() {
      score++;
      scoreBoard.textContent = "Skor: " + score;

      if (score === 8) {
        endGame(true); // Oyuncu kazandƒ±
      }
    }

// Klavye kontrol ayarlarƒ± 
    function setupKeyboard() {
      window.addEventListener("keydown", (e) => {
        if ([37, 38, 39, 40].includes(e.keyCode)) {
          e.preventDefault();
          keys[e.keyCode] = true;
        }
      });

      window.addEventListener("keyup", (e) => {
        if ([37, 38, 39, 40].includes(e.keyCode)) {
          keys[e.keyCode] = false;
        }
      });
    }

// Karakter ile engel √ßarpƒ±≈üma kontrol√º
    function detectCollision() {
      return obstacles.some(obs =>
        character.x < obs.x + obs.width - 20 &&
        character.x + character.width - 20 > obs.x &&
        character.y < obs.y + obs.height - 20 &&
        character.y + character.height - 20 > obs.y
      );
    }

// Engellerin hareketi
    function moveObstacles() {
      for (let obs of obstacles) {
        obs.x += obs.speedX;
        obs.y += obs.speedY;

        // Ekran sƒ±nƒ±rlarƒ±nda y√∂n deƒüi≈ütir
        if (obs.x <= 0 || obs.x + obs.width >= canvas.width) {
          obs.speedX *= -1;
        }
        if (obs.y <= 0 || obs.y + obs.height >= canvas.height) {
          obs.speedY *= -1;
        }
      }
    }

// Oyun ekranƒ±nƒ± s√ºrekli g√ºncelle
    function updateGameArea() {
      if (gameOver) return;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(bgImage, 0, 0);
      ctx.drawImage(appleImage, appleX, appleY, appleSize, appleSize);

      moveObstacles();

    // Engelleri √ßiz
      ctx.fillStyle = "brown";
      obstacles.forEach(obs => ctx.fillRect(obs.x, obs.y, obs.width, obs.height));
    
    // Karakter hareketini kontrol et
      character.speedX = 0;
      character.speedY = 0;

      if (keys[37]) character.speedX = -4; // Sol
      if (keys[39]) character.speedX = 4; // Saƒü
      if (keys[38]) character.speedY = -4; // Yukarƒ±
      if (keys[40]) character.speedY = 4; // A≈üaƒüƒ±

      ctx.shadowColor = "rgba(0, 0, 0, 0.3)";
      ctx.shadowBlur = 20;

      character.updatePosition();
      character.draw();

      ctx.shadowColor = "transparent";
      ctx.shadowBlur = 0;

    // Elma toplanƒ±rsa
      if (character.isTouchingApple()) {
        placeApple();
        updateScore();
        collectSound.currentTime = 0;
        collectSound.play();
      }

    // Engel √ßarpƒ±≈ümasƒ±
      if (detectCollision()) {
        endGame(false); // Oyuncu kaybetti
      }
    }

// Oyunu ba≈ülat
    function startGame() {
      score = 0;
      gameOver = false;
      timeLeft = 20;

      timerDisplay.textContent = "Kalan Zaman: " + timeLeft;
      scoreBoard.textContent = "Skor: 0";
      winMessage.style.display = "none";
      restartButton.style.display = "none";

      initializeCharacter();
      placeApple();
      setupKeyboard();
      backgroundMusic.play().catch(() => {});

    // Oyun d√∂ng√ºs√º
      gameInterval = setInterval(updateGameArea, 20);

    // Geri sayƒ±m ba≈ülat 
      timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = "Kalan Zaman: " + timeLeft;
        if (timeLeft <= 0) {
          endGame(false, true); // S√ºre doldu 
        }
      }, 1000);
    }

// Oyun biti≈ü ekranƒ± 
    function endGame(won, timeout = false) {
      gameOver = true;
      clearInterval(gameInterval);
      clearInterval(timerInterval);
      backgroundMusic.pause();

      if (won) {
        winMessage.style.display = "block"; // Kazanma mesajƒ± g√∂ster
      } else {
        gameOverSound.play();
        ctx.fillStyle = "red";
        ctx.font = "bold 48px sans-serif";
        const message = timeout ? "Zaman Doldu!" : "Oyun Bitti!";
        ctx.fillText(message, canvas.width / 2 - 140, canvas.height / 2);
      }

      restartButton.style.display = "inline-block";
    }

// Ba≈ülangƒ±√ß ekranƒ± √ßiz
    function drawStartScreen() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.drawImage(bgImage, 0, 0);
      ctx.fillStyle = "black";
      ctx.font = "bold 36px sans-serif";
      ctx.fillText("Click Start to Begin", canvas.width / 2 - 180, canvas.height / 2);
    }

// Ba≈ülat butonu i≈ülevi
    startButton.addEventListener("click", () => {
    document.getElementById("howToPlay").style.display = "none";
    startButton.style.display = "none";
    restartButton.style.display = "none";
    startGame();
    });

// Yeniden ba≈ülatma
    restartButton.addEventListener("click", () => {
      startGame();
    });

  </script>

</body>
</html>
